(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{547:function(s,t,a){"use strict";a.r(t);var e=a(21),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（"),a("a",{attrs:{href:"https://link.jianshu.com/?t=https://tools.ietf.org/html/rfc7519",target:"_blank",rel:"noopener noreferrer"}},[s._v("(RFC 7519"),a("OutboundLink")],1),s._v(").该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.xiaoyou66.com/images/2020/11/23/V4Usi.png",alt:"img"}})]),s._v(" "),a("p",[s._v("常见的加密算法有"),a("strong",[s._v("HMAC")]),s._v("和"),a("strong",[s._v("RSA")]),s._v("算法")]),s._v(" "),a("p",[s._v("jwt由三个部分组成："),a("code",[s._v("header")]),s._v("."),a("code",[s._v("payload")]),s._v("."),a("code",[s._v("signature")])]),s._v(" "),a("p",[s._v("header部分最常用的两个字段是"),a("code",[s._v("alg")]),s._v("和"),a("code",[s._v("typ")]),s._v("，"),a("code",[s._v("alg")]),s._v("指定了token加密使用的算法（最常用的为"),a("em",[s._v("HMAC")]),s._v("和"),a("em",[s._v("RSA")]),s._v("算法），typ`声明类型为JWT，一般情况下，header会长下面这个样子")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"alg"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HS256"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"typ"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jwt"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("payload则为用户数据以及一些元数据有关的声明，用以声明权限，举个例子，一次登录的过程可能会传递以下数据")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"user_role"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"finn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//当前登录用户")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"iss"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//该JWT的签发者")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"iat"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1573440582")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//签发时间")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"exp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1573940267")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//过期时间")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"nbf"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1573440582")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//该时间之前不接收处理该Token")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"domain"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"example.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//面向的用户")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"jti"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dff4214121e83057655e10bd9751d657"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Token唯一标识")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("signature的功能是保护token完整性。生成方法为将header和payload两个部分联结起来，然后通过header部分指定的算法，计算出签名。")]),s._v(" "),a("p",[s._v("抽象成公式就是")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("signature = HMAC-SHA256(base64urlEncode(header) + '.' + base64urlEncode(payload), secret_key)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("值得注意的是，编码header和payload时使用的编码方式为"),a("code",[s._v("base64urlencode")]),s._v("，"),a("code",[s._v("base64url")]),s._v("编码是"),a("code",[s._v("base64")]),s._v('的修改版，为了方便在网络中传输使用了不同的编码表，它不会在末尾填充"="号，并将标准Base64中的"+"和"/"分别改成了"-"和"-"。')]),s._v(" "),a("p",[a("a",{attrs:{href:"https://xz.aliyun.com/t/6776",target:"_blank",rel:"noopener noreferrer"}},[s._v("攻击JWT的一些方法 - 先知社区 (aliyun.com)"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=n.exports}}]);